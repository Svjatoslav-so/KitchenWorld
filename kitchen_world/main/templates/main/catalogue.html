{% extends "main/base_generic.html" %}

{% load static %}
{% load main_tags %}

{% block css %}
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/swiper@8/swiper-bundle.min.css" />
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <link rel="stylesheet" href="{% static 'main/css/catalogue_style.css' %}">
<!--    <link rel="stylesheet" href="main/css/catalogue_style.css">-->
{% endblock %}

{% block title %}<title>Kitchen World Соцсеть для кулинаров</title>{% endblock %}


{% block main_content %}
    <section class="section recipes">
        <div class="recipes-container ">
            <div class="recipes-wrapper">
                <div class="menu">
                    <ul class="menu">
                        <form method="get" id="cat_filt">
                            <button type="submit" class="btn submit active">Фильтровать</button>
                            <p>
                                ____________________________
                            </p>
<!--                            {% for cat in category %}-->
<!--                            <li class="menu__item">-->
<!--                                <details>-->
<!--                                    <summary>-->
<!--                                        <input  name="category" type="checkbox" value="{{cat.name}}" {% if cat.name in selected_categories %} checked {%endif%} >{{cat.name}}-->
<!--                                    </summary>-->
<!--                                    {% for s_cat in sub_category %}-->
<!--                                        {% if s_cat.parent_category == cat %}-->
<!--                                            <li class="menu__item">-->
<!--                                                <input  name="category" type="checkbox" value="{{s_cat.name}}" {% if s_cat.name in selected_categories %} checked {%endif%} >{{s_cat.name}}-->
<!--                                            </li>-->
<!--                                        {%endif%}-->
<!--                                    {% endfor %}-->
<!--                                </details>-->
<!--                            </li>-->
<!--                            {% endfor %}-->

                            {% autoescape off %}
                            {% show_categories selected_categories %}
                            {% endautoescape %}
                        </form>
                    </ul>
                </div>
                <div class="content">
                    <div class="content__info">
                        <h2 class="section-title">
                            Каталог
                        </h2>
                        <form class="search" action="#" method="get">
                            <input class="input" type="text" name="search-input" placeholder="Найти" id="search-input">
                            <button class="search-btn" type="submit"></button>
                        </form>
                        <div class="order">
                            <p class="order-title">Сортировать по:</p>
                            <select form="cat_filt" name="sort" id="order-list" class="order__list" onchange="this.form.submit()">
                                <option class="order__item" name="sort" value="-date_of_creation" {% if selected_sort == "-date_of_creation" %} selected {%endif%}>
                                        Дате
                                </option>
                                <option class="order__item" name="sort" value="-num_of_stars" {% if selected_sort == "-num_of_stars" %} selected {%endif%}>
                                        Популярности
                                </option>
                                <option class="order__item" name="sort" value="title" {% if selected_sort == "title" %} selected {%endif%}>
                                        Алфавиту
                                </option>
                            </select>
                        </div>
                    </div>
                    <div class="cards-wrapper">
                        <!-- Insert cards -->
<!--                        recipe_FILTER = Recipe.objects.all().order_by('date_of_creation')-->
                        {% for recipe, r_photo in recipes %}
                        <div class="card" data-recipeId="{{ recipe.id }}">
                            <div class="card__header">
                                <a href="#" class="card__recipe-autor">
                                    <img src="{{ recipe.user.author.photo.url }}" alt="" class="card__recipe-autor-avatar">
                                    <div class="card__recipe-inner">
                                        <h3 class="card__recipe-autor-named">{{ recipe.user.username|title }}</h3>
<!--                                        <span class="card__recipe-time">20.10.2022 в 15:58</span>-->
                                        <span class="card__recipe-time">{{ recipe.date_of_creation }}</span>
                                    </div>
                                </a>
                                <button type="button" class="card__dots"></button>
                            </div>
                            <a href="{{ recipe.get_absolute_url }}" class="card-link">
                                <img src="{{ r_photo.photo.url }}" alt="" class="card__img">
                            </a>

                            <div class="card__info">
                                <div class="card__interaction-wrapper">
                                    <div class="card__interaction">
                                        <button class="card__stars"></button>
                                        {{ recipe.num_of_stars }}
                                    </div>
                                    <div class="card__interaction">
                                        <button class="card__comments"></button>
                                        {{ recipe.num_of_comments }}
                                    </div>
                                    <div class="card__interaction">
                                        <button class="card__bookmarks"></button>
                                        {{ recipe.num_of_bookmarks }}
                                    </div>
                                </div>
                                <div class="card__statistics-wrapper">
                                    <div class="card__statistic">
                                        <button class="card__time"></button>
                                        {{ recipe.cooking_time }}
                                    </div>
                                    <div class="card__statistic">
                                        <button class="card__calories"></button>
                                        {{ recipe.calories }}
                                    </div>
                                </div>
                            </div>
                            <h3 class="card__title"><a href="{{ recipe.get_absolute_url }}" class="card-link">{{ recipe.title }}</a> </h3>
                            <p class="card__description">{{ recipe.description|truncatechars:100 }}<span
                                    class="card__more">ещё</span></p>
                            <div class="card__categories-wrapper">
                                {% for c in recipe.categories.all %}
                                <a class="category">#{{ c.name|lower }}</a>
                                {% endfor %}
                            </div>

                        </div>
                        {% endfor %}

                    </div>
                </div>
            </div>
        </div>


    </section>

{% endblock %}